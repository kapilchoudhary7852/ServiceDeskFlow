<div class="page-content-wrapper">
  <div class="page-content">
    <div class="page-contentInn">
      <div class="portlet solid light-grey main-dashboard-page">
        <div class="row">
          <div class="col-md-12">
            <h3 *ngIf="!IsMylisting" class="page-title">Listing</h3>
            <h3 *ngIf="IsMylisting" class="page-title">My issue</h3>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-2">
            <div class="form-group">
              <label for="">Service Desk:</label>
              <select class="input-select" [(ngModel)]='serviceDeskInput'>
                <option *ngFor="let desk of serviceDesks " [value]='desk.id'>{{desk.name}}</option>
              </select>
            </div>
          </div>

          <div class="col-sm-2">
            <div class="form-group">
              <label>Assignee</label>
              <select class="input-select" [(ngModel)]='AssigneeInput'>
                <option *ngFor="let d of userAssignee " [value]='d.id'>{{d.name}}</option>
              </select>
            </div>
          </div>

          <div class="col-sm-2">
            <div class="form-group">
              <label for="">Ticket:</label>
              <input class="input-ticketing-list" type="text" [(ngModel)]='ticketInput'>
            </div>
          </div>

          <div class="col-sm-6">

            <div class="form-group">
              <label for="" class="ticket-form">Resolved Date:</label>From
              <input class="datepick-input" type="date" [(ngModel)]='resolvedDateFromInput'>To
              <input class="datepick-input" type="date" [(ngModel)]='resolvedDateToInput'>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-sm-2">
            <div class="form-group">
              <label for="">Reporter:</label>
              <select class="input-select" [(ngModel)]='ReporterInput'>
                <option *ngFor="let d of userReporter " [value]='d.id'>{{d.name}}</option>
              </select>
            </div>
          </div>

          <div class="col-sm-2">
            <div class="form-group">
              <label for="">Priority:</label>
              <select class="input-select" [(ngModel)]='priorityInput'>
                <option *ngFor="let priority of prioritys" [value]='priority.id'>{{priority.name}}</option>
              </select>
            </div>
          </div>

          <div class="col-sm-2">
            <div class="form-group">
              <label for="">Status:</label>
              <select class="input-select" [(ngModel)]='statusInput'>
                <option *ngFor="let da of status" [value]='da.id'>{{da.name}}</option>
              </select>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label for="" class="ticket-form">Ticket Date:</label>
              <span class="ml-5">From</span>
              <input class="datepick-input" type="date" [(ngModel)]='ticketDateFromInput'>
              <span class="ml-5">To</span>
              <input class="datepick-input" type="date" [(ngModel)]='ticketDateToInput'>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-sm-12 text-center mb-20">
              <button class="btn btn-primary goBtn" (click)='filterTickets()'>Search Ticket</button>
              <button class="btn btn-primary goBtn mar-left" (click)='resetFilters()'>Reset</button>
          </div>
        </div>

        <div class="table-responsive">
            <table class="table table-bordered table-hover">
                <th>
                  <tr>
                    <td width="5%">#</td>
                    <td width="8%">Service Desk</td>
                    <td width="8%">Issue Title</td>
                    <td width="10%">Notify To</td>
                    <td width="8%">Assignee</td>
                    <td width="10%">Reporter</td>
                    <td width="6%">Status</td>
                    <td width="6%">Priority</td>
                    <td width="10%">Ticket Date</td>
                    <td width="8%">Resolve Date</td>
                    <td width="10%">Resolve Duration(Hr)</td>
                    <td width="10%">Action</td>
                  </tr>
                  <tr *ngIf="tickets.length==0">
                    <td>NO data found</td>
                  </tr>
                  <tr *ngFor="let ticket of tickets ; let i = index">
                    <td>{{ i+1 }}</td>
                    <td>{{ ticket.ServiceDeskName }}</td>
                    <td>{{ ticket.IssueTitle }}</td>
                    <td>
                      <div *ngFor="let user of ticket.NotifyToName">{{user}}</div>
                    </td>
                    <td>{{ ticket.AssignedName }}</td>
                    <td>{{ ticket.CreatedName }}</td>
                    <td>{{ ticket.StatusName }}</td>
                    <td>{{ ticket.PriorityName }}</td>
                    <td>{{ ticket.CreatedDate}}</td>
                    <td>{{ ticket.ResolvedDate }}</td>
                    <td>{{ ticket.ResolvedDuration }}</td>
                    <td>
                      <div *ngIf="!IsMylisting ">
                        <button *ngIf="RoleId == 2 || RoleId == 3" type="button" (click)='assignTicket(ticket._id,ticket.ServiceDeskId)'>Assign</button>
                      </div>
                      <button *ngIf="RoleId == 4" type="button" (click)='updateTicket(ticket,2)'>Self Assign</button>
                      <button *ngIf="ticket.Assigned == null && ticket.CreatedBy== CreatedBy && IsMylisting" type="button" (click)='updateTicket(ticket,1)'>Delete</button>
                      <button type="button" routerLink="/ticketdetails/{{ticket._id}}">View</button>
                      <button *ngIf="ticket.Status == 5 && ticket.CreatedBy== CreatedBy" type="button" (click)='assignTicket(ticket._id,ticket.ServiceDeskId)'>Reopen</button>
                    </td>
                  </tr>
                </th>
              </table>
        </div>
      </div>


      <!-- <ng-multiselect-dropdown [data]="userAssignee" [(ngModel)]='AssigneeInput'  [placeholder]="'Select users'"  
      [settings]="dropdownSettings" (onSelect)="onItemSelect($event,1)" (onSelectAll)="onSelectAll($event,1)">
    </ng-multiselect-dropdown> -->
    </div>


    <!-- <ng-multiselect-dropdown [data]="userReporter" [(ngModel)]='ReporterInput'  [placeholder]="'Select users'"  
      [settings]="dropdownSettings" (onSelect)="onItemSelect($event,2)" (onSelectAll)="onSelectAll($event,2)">
    </ng-multiselect-dropdown> -->

  </div>

  

</div>
<div>
  <div>
    <label>Assignee:</label>
    <select [(ngModel)]='newAssigned'>
      <option *ngFor="let d of newAssignusers" [value]='d._id'>{{d.Fname+' '+d.Lname}}</option>
    </select>
  </div>
  <label>Comment:</label>
  <input type="text" [(ngModel)]='newticketComment'>
  <br>
  <button type="button" (click)='funNewAssigned(1)'>Assign</button>
  <button type="button" (click)='funResetAssigned()'>Reset</button>
</div>
<div>
  <label>Comment:</label>
  <input type="text" [(ngModel)]='newticketComment'>
  <br>
  <button type="button" (click)='funNewAssigned(2)'>Reopen</button>
  <button type="button" (click)='funResetAssigned()'>Reset</button>
</div>